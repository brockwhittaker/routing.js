var ModuleBuilder=function(){var e={};return{"new":function(t){return e[t]?void console.warn("Error. Module with name `"+t+"` already exists."):(e[t]={},new IndModule(e[t]))},find:function(t){return e[t]?new IndModule(e[t]):void console.warn("Error. Module with name `"+t+"` does not exist.")},"delete":function(t){e[t]?delete e[t][key]:console.warn("Error. Tried deleting module `"+t+"` but does not exist.")},get:function(t){return e[t]?e[t]:(console.warn("Error. Module with name `"+t+"` does not exist."),{})},set:function(t,n){return e[t]?console.warn("Error. Module with name `"+t+"` already exists."):e[t]=n,this}}},IndModule=function(e){return{"new":function(t){return e[t]?void console.warn("Error. Module with name `"+t+"` already exists."):(e[t]={},new IndModule(e[t]))},find:function(t){return e[t]?new IndModule(e[t]):void console.warn("Error. Module with name `"+t+"` does not exist.")},setKey:function(t,n){return e?e[t]=n:console.warn("Error. Module does not exist."),this},setKeys:function(t){if(e)for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return this},getKey:function(t){return e[t]?e[t]:{}},deleteKey:function(t){e?delete e[t]:console.warn("Error. Tried deleting key `"+t+"` but does not exist.")}}},module=ModuleBuilder(),Listeners=function(){var e={events:{},nodes:{}},t={findInArray:function(e,t){var n=!1;return e.forEach(function(e){n=n||t(e)}),n},addListener:function(e,t,n){var r=this;e.addEventListener(n,function(e){r.applyAllEvents(t,n,function(t){t[2]&&t[0].call(this,e)}.bind(this))})},addPrevListeners:function(t){if(e.events[t]){var n=this,r=Object.keys(e.events[t]);r.forEach(function(e){n.updateClassEvents(t,e)})}},purgeDeadNodes:function(t){e.nodes[t]&&(e.nodes[t]=e.nodes[t].filter(function(e){return document.body.contains(e[0])}))},addIndividualEvent:function(t,n,r,o){e.events[t][n]||(e.events[t][n]=[]);var i=function(e){return e[1]==r};this.findInArray(e.events[t][n],i)?console.warn("A function with the name `"+r+"` already exists."):e.events[t][n].push([o,r,!0])},removeEvent:function(t,n,r){e.events[t]&&e.events[t][n]&&(e.events[t][n]=e.events[t][n].filter(function(e){return e[1]!==r}))},disableEvent:function(t,n,r){if(e.events[t]&&e.events[t][n])for(var o=e.events[t][n],i=0;i<o.length;i++)if(o[i][1]==r)return void(o[i][2]=!1)},enableEvent:function(t,n,r){if(e.events[t]&&e.events[t][n])for(var o=e.events[t][n],i=0;i<o.length;i++)if(o[i][1]==r)return void(o[i][2]=!0)},updateClassEvents:function(t,n){if(e.nodes[t]){this.purgeDeadNodes(t);for(var r,o=e.nodes[t].length-1;o>=0&&(r=e.nodes[t][o],!r[1][n]);o--)this.addListener(r[0],t,n),r[1][n]=!0}},applyAllEvents:function(t,n,r){e.events[t][n].forEach(function(e){r(e)})},objectLoop:function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)}};return{add:function(n,r){e.events[n]||(e.events[n]={}),t.objectLoop(r,function(e,r){t.objectLoop(e,function(e,o){t.addIndividualEvent(n,r,o,e),t.updateClassEvents(n,r)})})},remove:function(e,n,r){t.removeEvent(e,n,r)},enable:function(e,n,r){t.enableEvent(e,n,r)},disable:function(e,n,r){t.disableEvent(e,n,r)},_addNode:function(n,r){e.nodes[n]||(e.nodes[n]=[]),e.nodes[n].push([r,{}]),t.addPrevListeners(n)},_removeNode:function(t,n){e.nodes[t]&&(e.nodes[t]=e.nodes[t].filter(function(e){return!n.isSameNode(e[0])}))},_test:function(){return e}}};module.set("listeners",Listeners),module.set("ajax",function(e,t,n){var r=new XMLHttpRequest;r.onreadystatechange=function(){r.readyState==XMLHttpRequest.DONE&&(200==r.status?t.success(r.responseText):400==r.status?t.error(r.responseText,{error:400}):t.error(r.responseText,{error:"unknown"}))},n===!1&&(e+="?t="+(new Date).getTime()),r.open("GET",e,!0),r.send()});var Storage={namespace:function(e){return{set:function(t,n,r){var o=(this.get(t),{value:n,lastUpdated:r});localStorage.setItem(e+"_"+t,JSON.stringify(o))},get:function(t){var n=localStorage.getItem(e+"_"+t);return n?JSON.parse(n):null},lastUpdated:function(e){var t=this.get(e);return!!t&&t.lastUpdated}}}};module.set("storage",Storage),module.set("config",function(e,t){for(var n in e)e.hasOwnProperty(n)&&"undefined"!=typeof t.config[n]?t.config[n]=e[n]:console.warn("Warning. Cannot set new property '"+n+"' to config.");return this.proto}),module.set("controller",{scope:function(e,t){var n=t.routes[t.view.current],r=n.state;setTimeout(function(){e(r,r.data,{container:t.container,loaded:!!n.hasLoaded,loads:n.loads})})}}),module.set("DOM",{append:function(e,t){t.appendChild(e)},prepend:function(e,t){t.insertBefore(e,t.firstChild)},after:function(e,t){t.parentNode.insertBefore(e,t.nextSibling)},before:function(e,t){t.parentNode.insertBefore(e,t)},remove:function(e){e.parentNode.removeChild(e)},fillWithObjectProperties:function(e,t){var n,r,o=(e.querySelectorAll("[b-prop]"),module.get("util")),i={"b-prop":"innerHTML","b-src":"src","b-href":"href"};for(var a in i)i.hasOwnProperty(a)&&(n=node.getAttribute(a),"undefined"!=typeof n&&null!==n&&(r=o.dotToObject(t,path),node.removeAttribute(a),node[i[a]]=r));return e},parentAndChildren:function(e){var t=[e];if(e.querySelectorAll)for(var n=e.querySelectorAll("*"),r=0;r<n.length;r++)t.push(n[r]);return t},allParents:function(e){for(var t=[];e.parentNode;)t.unshift(e.parentNode),e=e.parentNode;return t},hasRepeatParent:function(e){for(;e.parentNode&&e.parentNode.hasAttribute;){if(e.parentNode.hasAttribute("b-repeat"))return!0;e=e.parentNode}return!1}}),module.set("hash",{"public":{get:function(e){var t=window.location.hash.substr(2),n=t.match(/^[\w_-]+/),r=t.replace(/^[\w_-]+\?{0,}/,""),o={};return r.length>0&&(r=r.split(/&/g).map(function(e){return e.split(/=/g)}),o={},r.forEach(function(e){o[e[0]]=e[1]})),!!n&&("undefined"!=typeof e&&null!==e?o[e]:{view:n[0],get:o})},set:{view:function(e){var t=module.get("hash"),n=t["public"].get(),r=t["private"].concatGet(n.get);n?window.location.hash="/"+e+(r?"?"+r:""):window.location.hash="/"+e},get:function(e){var t=module.get("hash"),n=t["public"].get(),r=t["private"].concatGet(e);if(!n)throw"Error. No view currently set.";window.location.hash="/"+n.view+(r?"?"+r:"")}}},"private":{concatGet:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push([n,e[n]]);return t.map(function(e){return e.join("=")}).join("&")}}}),module.set("init",function(e,t){window.onhashchange=function(){var t=module.get("hash")["public"].get();module.get("view")["new"](t.view,e)}.bind(this),e.container="string"==typeof t?document.querySelectorAll(t)[0]:t,module.get("mutation").addEvents(e)}),module.set("load",{html:function(e,t,n){var r=module.get("ajax");r(e,{success:function(e){t(e)},error:function(e,n){throw t(e),n}},n)},script:function(e,t,n){e.script&&document.body.removeChild(e.script),e.script=document.createElement("script"),e.script.onload=function(){n()},e.script.src=t,document.body.appendChild(e.script)},page:function(e,t,n){var r={html:!1,script:!1},o=function(){this.script(e,t.url.script,function(){r.script=!0,n()})}.bind(this);if(t.content.html&&e.config.cache){for(r.html=!0;e.container.firstChild;)e.container.removeChild(e.container.firstChild);e.container.innerHTML=t.content.html,o()}else this.html(t.url.html,function(n){for(r.html=!0,t.content.html=n;e.container.firstChild;)e.container.removeChild(e.container.firstChild);e.container.innerHTML=t.content.html,o()},e.config.cache)}}),module.set("mutation",{observe:function(e,t){var n=new MutationObserver(function(e){e.forEach(function(e){"childList"==e.type&&t(e)})}),r={attributes:!0,childList:!0,characterData:!0,subtree:!0};return n.observe(e.container,r),n},addEventsToNode:function(e,t){var n=["click","input","mousemove"],r=function(){},o=t.getAttribute("b-events"),i=t.getAttribute("b-name");if(i){var a=module.get("scope");a.create.key(e,i),document.body.contains(t)&&e[i].self.indexOf(t)==-1&&e[i].self.push(t),o&&o.split(/,/).forEach(function(n){e[i][n]=e[i][n]||r,t.addEventListener(n,function(t){e[i][n].call(this,t)})})}n.forEach(function(n){var r=t.getAttribute("b-"+n);r&&(t.eventsApplied||(t.eventsApplied=!0,t.addEventListener(n,function(t){"function"==typeof e[r]&&e[r].call(this,t)})))})},addRepeatToNode:function(e,t){var n=module.get("util"),r=module.get("repeater"),o=t.getAttribute("b-repeat");n.immutable(e.data.repeat,o,r(o,t))},removeNode:function(e,t){if(1===t.nodeType&&t.hasAttribute("b-name")){var n=module.get("util"),r=t.getAttribute("b-name"),o=e.current[r]||e.old[r];n.mutable(o,"self"),o.self=o.self.filter(function(e){return!t.isSameNode(e)}),e.current.event._removeNode(r,t),n.immutable(o,"self")}},addEvents:function(e){var t=this,n=function(e,n){var r=module.get("DOM"),o=r.parentAndChildren(n);o.forEach(function(n,r){1===n.nodeType&&(t.addEventsToNode(e.current,n),n.hasAttribute("b-name")&&e.current.event._addNode(n.getAttribute("b-name"),n),n.hasAttribute("b-repeat")&&t.addRepeatToNode(e.current,n),n.hasAttribute("b-repeat-in"))})};e.observe=this.observe(e,function(r){var o,i=r.addedNodes,a=r.removedNodes,s={current:e.routes[e.view.current].state,old:e.view.old?e.routes[e.view.old].state:null};for(o=0;o<a.length;o++)t.removeNode(s,a[o]);for(o=0;o<i.length;o++)n(s,i[o])})}});var Repeater=function(e,t,n,r){var o={original:null,marker:null,data:[],elems:[],viewModifier:{}},i={normalizeArgs:function(e,t,n,r){var o={index:e,data:t,viewModifier:n,callback:r};return"function"==typeof n&&(o.callback=n,delete o.viewModifier),o},sanitizeData:function(e){return delete e.__meta,e},clone:function(e){var t;if(null===e||"object"!=typeof e)return e;if(e instanceof Date)return t=new Date,t.setTime(e.getTime()),t;if(e instanceof Array){t=[];for(var n=0,r=e.length;n<r;n++)t[n]=this.clone(e[n]);return t}if(e instanceof Object){t={};for(var o in e)e.hasOwnProperty(o)&&(t[o]=this.clone(e[o]));return t}throw new Error("Unable to copy obj! Its type isn't supported.")},objectLoop:function(e,t){for(var n in e)e.hasOwnProperty(n)&&t(e[n],n)},generateID:function(){return(1e16*Math.random()).toString(32)},generateFromArray:function(e){for(var t=0;t<e.length;t++){var n=this.createNodeFromTemplate(e[t]);n.index=t,n.repeat=a,o.marker.parentNode.insertBefore(n,o.marker),n.bParent=r,o.elems.push(n),o.data.push(e[t])}o.marker.parentNode.removeChild(o.marker)},init:function(e,t,n,r){window._Repeater||(window._Repeater={}),e&&(window._Repeater[e]=r);this.generateID();o.marker=this.createMarker(this.generateID()),o.original=this.node.store(t),t.parentNode.insertBefore(o.marker,t),t.parentNode.removeChild(t),n&&this.generateFromArray(n,r)},createMarker:function(e){var t=document.createElement("div");return t.className="_marker",t.style.visibility="hidden",t.style.display="none",t.hidden=!0,t.dataset.id=e,t},node:{store:function(e){var t=e.cloneNode(!0);return t.hasAttribute("b-repeat-in")&&(t.removeAttribute("b-repeat-in"),t.setAttribute("b-repeated-in",!0)),t},set:function(e,t,n,r){var o,a,s,u={"b-prop":"innerHTML","b-src":"src","b-href":"href","b-style":null};i.objectLoop(u,function(r,u){if(o=e.getAttribute(u),"undefined"!=typeof o&&null!==o)switch(u){case"b-style":a=i.parse.dotToObj(t,o),a&&"object"==typeof a&&i.objectLoop(a,function(t,n){e.style[n]=t});break;case"b-prop":a=i.parse.dotToObj(t,o),s=i.parse.dotToObj(n||{},o),e[r]=s?s(a):a;break;default:a=i.parse.dotToObj(t,o),s=i.parse.dotToObj(n||{},o),e.setAttribute(r,s?s(a):a)}})},isInsideBRepeatIn:function(e,t){for(;e.parentNode;){if(e=e.parentNode,e.isSameNode(t))return!1;if(e.hasAttribute("b-repeat-in")||e.hasAttribute("b-repeated-in"))return!0}return!1}},createNodeFromTemplate:function(e,t){var n=o.original.cloneNode(!0),r=n.querySelectorAll("*");t&&(o.viewModifier=t);for(var a,s,u=0;u<r.length;u++){if(r[u].hasAttribute("b-repeat-in")&&(a=r[u].getAttribute("b-repeat-in"),s=i.parse.dotToObj(e,a),!this.node.isInsideBRepeatIn(r[u],n))){n.repeat||(n.repeat={});var c=r[u].getAttribute("b-name");r[u].bParent=n,c?n.repeat[c]=Repeater(null,r[u],s,n):n.repeat[a]=Repeater(null,r[u],s,n)}this.node.isInsideBRepeatIn(r[u],n)||(this.node.set(r[u],e,t,n),r[u].bParent=n)}return n.removeAttribute("b-repeat"),n},createNodeFromNode:function(e,t){for(var n=t.cloneNode(!0),r=n.querySelectorAll("*"),i=0;i<r.length;i++)this.node.isInsideBRepeatIn(r[i],n)||(this.node.set(r[i],e,o.viewModifier,n),r[i].bParent=n);return n.removeAttribute("b-repeat"),n.cloned=!0,n},parse:{dotToObj:function(e,t){if("string"==typeof t){t=t.split(/\./);for(var n=0;n<t.length;n++){if("undefined"==typeof e[t[n]]||null===e[t[n]])return;e=e[t[n]]}return e}throw"Error. Path must be a string."}},DOM:{transferProps:function(e,t){["repeat","dataset","bParent"].forEach(function(n){t[n]=e[n]})},_inner:{after:function(e,t){t?t.nextSibling?this.before(e,t.nextSibling):t.parentNode&&t.parentNode.appendChild(e):this.after(e,o.marker)},before:function(e,t){t.parentNode.insertBefore(e,t)},prepend:function(e){this.after(e,o.marker)},append:function(e){this.after(e,o.elems[o.elems.length-1])},at:function(e,t){o.elems[t]?this.before(e,o.elems[t]):this.append(e)},remove:function(e){e.parentNode.removeChild(e)},removeAt:function(e){o.elems[e]&&this.remove(o.elems[e])}},push:function(e){this._inner.append(e)},unshift:function(e){this._inner.prepend(e)},at:function(e,t){this._inner.at(e,t)},pop:function(){this._inner.removeAt(o.elems.length-1)},shift:function(){this._inner.removeAt(0)},removeAt:function(e){this._inner.removeAt(e)},replace:function(e,t){e.parentNode.replaceChild(t,e)}},bindID:function(e,t){var n=this.generateID();t.__meta={id:n},e.dataset.b_id=n}},a={push:function(e,t){if(Array.isArray(e))e.forEach(function(e,n){this.push(e,t)}.bind(this));else{var n=i.createNodeFromTemplate(e,o.viewModifier);i.bindID(n,e),i.DOM.push(n),o.data.push(e),o.elems.push(n),t&&t(n)}},unshift:function(e,t){if(Array.isArray(e))e.forEach(function(e,n){this.unshift(e,t)});else{var n=i.createNodeFromTemplate(e,o.viewModifier);i.bindID(n,e),i.DOM.unshift(n),o.data.unshift(e),o.elems.unshift(n),t&&t(n)}},at:function(e,t,n){var r=i.createNodeFromTemplate(t,o.viewModifier);i.bindID(r,t),i.DOM.at(r,e),o.data.splice(e,0,t),o.elems.splice(e,0,r),n&&n(r)},pop:function(){i.DOM.pop(),o.data.pop(),o.elems.pop()},shift:function(){i.DOM.shift(),o.data.shift(),o.elems.shift()},remove:function(e){var t;if("object"==typeof e&&(t=e.dataset.b_id,o.data.forEach(function(n,r){n.__meta.id==t&&(e=r)}),"object"==typeof e))throw e=-1,"Error. This node couldn't be found in the repeat sequence.";i.DOM.removeAt(e),o.data.splice(e,1),o.elems.splice(e,1)},filter:function(e){o.data=o.data.map(function(t){return!!e(t)&&t}),o.elems=o.elems.filter(function(e,t){return o.data[t]!==!1||(i.DOM._inner.remove(e),!1)}),o.data=o.data.filter(function(e){return e})},get:function(){var e=i.sanitizeData(i.clone(o.data));return e.forEach(function(e){delete e.__meta}),e},modify:function(e,t,n){var r,a=i.normalizeArgs(e,null,t,n);if("object"==typeof a.index){if(r=a.index.dataset.b_id,o.data.forEach(function(t,n){t.__meta.id==r&&(e=n)}),"object"==typeof e)throw e=-1,"Error. This node couldn't be found in the repeat sequence."}else e=a.index;var s=o.data[e].__meta;a.callback.call(null,i.sanitizeData(o.data[e])),o.data[e].__meta=s;var u=i.createNodeFromNode(o.data[e],o.elems[e],a.viewModifier||o.viewModifier);i.DOM.transferProps(o.elems[e],u.cloneNode(!0)),i.DOM.replace(o.elems[e],u),o.elems[e]=u},modifyEach:function(e,t){for(var n,r=i.normalizeArgs(null,null,e,t),a=0;a<o.elems.length;a++)n=o.data[a].__meta,this.modify(a,r.viewModifier,r.callback.bind(null,o.data[a],a)),o.data[a].__meta=n},modifyView:function(e){o.viewModifier=e,this.modifyEach(function(){})}};return i.init(e,t,n,a),a};module.set("repeater",Repeater),module.set("routes",{add:function(e,t,n,r){var o=module.get("scope");if(r.routes[e])throw"Error. Route with the name '"+e+"' already exists.";r.routes[e]={name:e,url:{html:t,script:n},content:{html:null},state:{},hasLoaded:!1,loads:0};var i=r.routes[e].state;o.create.scope(r,i,r.routes)},deploy:function(e,t,n){var r=e.routes[t],o=module.get("scope"),i=module.get("hash"),a=module.get("load");if(r.hasLoaded===!1?r.hasLoaded=0:0===r.hasLoaded&&(r.hasLoaded=!0),r.loads++,!r)throw"Error. Route with the name '"+t+"' does not exist.";return i["public"].set.view(t),o.removeAllNodeRefs(e.routes[t].state),a.page(e,r,function(e){console.log("loaded route '"+t+"'!"),n&&n()}),this}}),module.set("scope",{create:{key:function(e,t){var n=module.get("util").immutable;e[t]||(e[t]={},n(e[t],"data",{}),n(e[t],"self",[]),n(e[t],"each",function(n){var r=e[t].self||[];r.forEach(function(r,o){n(r,o,e[t].self)})}))},scope:function(e,t,n){var r=module.get("util").immutable,o=module.get("scope"),i=module.get("listeners");o.repeat(t),r(t,"data",{}),r(t,"_",{CLEAR_INPUT:!0}),r(t.data,"save",o.save.bind(this,t,e)),r(t.data,"retrieve",o.retrieve.bind(this,t,e)),r(t.data,"apply",function(n){return o.apply(t,e,n)}),r(t.data,"remove",o.remove.bind(this,t,e)),r(t.data,"lastUpdated",function(){return o.lastUpdated(t,e)}),r(t,"get",function(e){return t[e]?t[e]:(o.create.key(t,e),console.warn("Error. This property with name '"+e+"' doesn't exist yet."),t[e])}),r(t,"event",i()),r(t.data,"prop",function(e,n,r){return t[e]||(o.create.key(t,e),console.warn("The property with name '"+e+"' doesn't exist yet, but was just created.")),t[e].data[n]=r,t[e].data[n]}),r(t.data,"transfer",function(n,r){var o=t.data[r];if("undefined"==typeof o||null===o)throw"Error. Data associated with key '"+r+"' does not exist.";if(!e.routes[n])throw"Error. View with the name '"+name+"' does not exist.";e.routes[n].state.data[r]=o}),r(t.data,"repeat",{}),o.toolkit(t)}},repeat:function(e){var t=module.get("util"),n=t.immutable;n(e,"repeat",function(t){return e.data.repeat[t]?e.data.repeat[t]:void console.warn("Error. Repeat associated with key '"+t+"' does not exist yet.")})},removeAllNodeRefs:function(e){var t=module.get("util");for(var n in e)e[n].self&&t.tempUnlock(e[n],"self",function(e){e.self=[]});return e}}),module.find("scope").setKeys({save:function(e,t,n){var r=new Storage.namespace(t.view.current);r.set("data",e.data,(new Date).getTime())},retrieve:function(e,t){var n=new Storage.namespace(t.view.current),r=n.get("data");return r},lastUpdated:function(e,t){var n=new Storage.namespace(t.view.current);return n.lastUpdated("data")},remove:function(e,t){var n=new Storage.namespace(t.view.current);n.set("data",{},(new Date).getTime())},apply:function(e,t){var n=new Storage.namespace(t.view.current),r=n.get("data");if("object"==typeof r&&r){r=r.value;for(var o in r)e.data[o]=r[o];return Object.keys(r).length>0}return!1}}),module.find("scope").setKey("toolkit",function(e){var t={setVals:function(e,t,n){if("object"==typeof n)for(var r in n)e.get(r).self.forEach(function(e){e[t]=n[r]})},getVals:function(e,t){return e[0][prop]}},n=module.get("util").immutable;n(e,"edit",{text:function(n){return t.setVals(e,"innerText",n),this},html:function(n){return t.setVals(e,"innerHTML",n),this}}),n(e,"input",{val:function(t,n){if(Array.isArray(t)){var r,o={};return t.forEach(function(t){r=e.get(t).self,r&&r.length>0&&(r.length>1?o[t]=r.map(function(e){return e.value}):o[t]=r[0].value)}),n&&this.clear(t),o}console.warn("Error. `$scope.input.val` must be passed an array parameter of valid b-name nodes.")},clear:function(t){if(Array.isArray(t)){var n;t.forEach(function(t){n=e.get(t).self,n&&n.forEach(function(e){e.value=""})})}else console.warn("Error. `$scope.input.clear` must be passed an array parameter of valid b-name nodes.")}})}),module.set("transition",{clonePage:function(e){e.copy&&(e.copy.parentNode.removeChild(e.copy),e.copy=null),e.copy=e.container.cloneNode(!0),e.copy.className=e.view.old+"-namespace",e.copy.id="clone_node"},hideContainer:function(e){e.container.style.display="none"},appendCopy:function(e){var t=e.container.parentNode;t.insertBefore(e.copy,e.container.nextSibling),e.container.scrollTop=0},callback:{set:function(e,t){t.transition=e},after:function(e){e.copy&&(e.copy.parentNode.removeChild(e.copy),e.copy=null),"none"==e.container.style.display&&(e.container.style.display="block"),e.animation.inProgress=!1}},before:function(e,t){this.clonePage(e),this.appendCopy(e),console.log("Copy appended at "+(new Date).getTime()),setTimeout(function(){this.hideContainer(e),console.log("Container hidden at "+(new Date).getTime()),t()}.bind(this),50)}}),module.set("util",{immutable:function(e,t,n){var r={writable:!1,configurable:!0};return n&&(r.value=n),Object.defineProperty(e,t,r),this},mutable:function(e,t){Object.defineProperty(e,t,{writable:!0})},tempUnlock:function(e,t,n){this.mutable(e,t),n(e),this.immutable(e,t)},dotToObject:function(e,t){return t=t.split(/\./),t.forEach(function(t){e[t]&&(e=e[t])}),"object"!=typeof e||Array.isArray(e)?e:""},findNearestParentRepeat:function(e){for(var t;e.parentNode;)e.parentNode.repeat&&(t=e.parentNode),e=e.parentNode;return t},isSample:function(e){for(;e.parentNode;){if(e.parentNode.hasAttribute("b-repeat"))return!0;e=e.parentNode}return!1}}),module.set("view",{"new":function(e,t){var n=module.get("hash"),r=module.get("transition"),o=module.get("routes"),i={replaceNamespace:function(e,t){return e.className=e.className.split(/\s+/g).filter(function(e){return!/-namespace/g.test(e)&&e}).concat(t+"-namespace").join(" "),e}};if(e!==t.view.current&&null!==t.view.current&&t.routes[e]){var a=t.routes[t.view.current].state;"function"==typeof a.unload&&a.unload(),t.view.old=t.view.current,t.view.current=e,t.animation.inProgress=!0,n["public"].set.view(e),r.before(t,function(){i.replaceNamespace(t.container,e),o.deploy(t,e,function(){t.transition?(console.log("Transition started at "+(new Date).getTime()),t.transition.call(null,r.callback.after.bind(null,t),{old:t.copy,"new":t.container},{"new":t.view.current,old:t.view.old})):r.callback.after(t)})})}else e!==t.view.current&&t.routes[e]?(t.view.old=t.view.current,t.view.current=e,t.animation.inProgress=!0,t.container=i.replaceNamespace(t.container,e),o.deploy(t,e,function(){r.callback.after(t)})):t.routes[e]?e===t.view.current:console.warn("Error. The route '"+e+"' does not exist.")}});var RouteConfig=function(e){"use strict";var t={script:null,routes:{},config:{cache:!0},container:null,copy:null,view:{current:null,old:null},animation:{inProgress:!1},observer:null,_prototype:n};module.get("init")(t,e);var n={add:function(e,n,r){return module.get("routes").add(e,n,r,t),this},deploy:function(e){return module.get("view")["new"](e,t),this},config:function(e){module.get("config")(e,t)},hash:module.get("hash")["public"],transition:function(e){module.get("transition").callback.set(e,t)},controller:function(e){module.get("controller").scope(e,t)}};return n};